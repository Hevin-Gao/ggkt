# 搭建项目环境和开发讲师管理接口

## 前后端分离开发概念

### 

## 搭建项目后端环境

基于maven


### 第一步：创建数据库和表

### 第二步：maven聚合工程搭建项目环境

- 父工程ggkt_parent

	- 类型：pom类型（用Spring Boot其余子模块用maven）
	- 功能：统一管理依赖版本和公共依赖

		- 删除无用的SRC目录
		- <properties>
定义各个依赖的版本
</properties>
		-  <version>${swagger.version}</version>
版本锁定

	- 子模块

		- model

		  maven模块
		  

			- 模块内容：表对应的实体类和公共枚举类等
			- ggkt_parent->New Module

		- service

			- 所有微服务模块
			- 类型：pom类型
			- service子模块

				- 子模块service_vod:视频点播模块

## 讲师管理后端

### 讲师接口

- 查询所有

	- 使用mp代码生成器把讲师相关的代码生成出来
	- 创建controller

		- @RestController

			- @RestController 是@controller和@ResponseBody 的结合
@Controller 将当前修饰的类注入SpringBoot IOC容器，使得从该类所在的项目跑起来的过程中，这个类就被实例化
@ResponseBody 它的作用简短截说就是指该类中所有的API接口返回的数据,会以Json字符串的形式返回给客户端

		- @RequestMapping("/admin/vod/teacher")

			- @RequestMapping注解可以将HTTP请求映射给controller

		- @Autowired:controller注入service
		- @GetMapping():将控制器方法映射到一个特定的HTTP方法上

	- 创建service

		- service注入mapper(mp已经将mapper注入service)

	- 创建mapper
	- 创建配置文件
	- 创建启动类

		- 位置

	- 创建配置类

		- config

			- 配置类注解Configuration

- 逻辑删除讲师接口

	- Teacher类

		- @TableName("teacher") //表示实体类对应表的名字
		- @TableField("name")//表示属性对应表中的字段

	- TeacherController

		- @DeleteMapping("remove{id}")id占位符
public boolean removeTeacher(@PathVariable Long id)
		- teacherService.removeById(id)
		- 后端测试

			- 引入Swgger测试

				- 原因

					- 删除讲师接口是delete提交方式用浏览器无法访问，通过测试工具postman 或者整合swagger2进行接口测试

						- swagger2能够生成各种提交方式及接口文档

				- 步骤

					- 1.common配置swagger2

						- Service_utils

							- @Configuration配置类注解
							- @EnableSwagger2:开启Swagger功能

					- 2.Service_vod pom.xml引入文件
					- 3.Service_vod启动类中加入@ComponentScan()
@ComponentScan(basePackages = "com.atguigu")//com.atguigu该目录下的类都进行加载
					- 4.启动ip:端口号/swagger-ui.html

						- http://localhost:8301/swagger-ui.html

				- Swagger中文提示

					- 定义在类上：@Api
					- 定义在方法上：@ApiOperation
					- 定义在参数上：@ApiParam

		- 前端开发

			- swagger2完成测试后

- 分页条件查询讲师

	- config中配置配置类
	- @ApiOperation("条件查询分页")
@GetMapping("findQueryPage/{current}/{limit}")加上当前页以及每页显示的记录数

		- 条件部分：QueryWrapper<Teacher> wrapper = new QueryWrapper<>();
		- 分页部分：Page<Teacher> pageParam = new Page<>(current,limit);
		- @RequestBody(required=false) TeacherQueryVo teacherQueryVo 前端的数据提交给后端
1.提交参数以json格式提交
2.条件值可以为空
3.和post提交一起使用
		- @ResponseBody将数据以json格式传递给前端

- 添加讲师

	-     @ApiOperation("添加讲师")
	-     @PostMapping("saveTeacher")

- 修改讲师
- 批量删除讲师

	- 批量删除讲师id以json格式数组传递
json数组[1,2,3]
	-     @ApiOperation("批量删除讲师")
    @DeleteMapping("removeBatch")
	- public Result removeBatch(@RequestBody List<Long> idList)

### 统一返回结果

- 1.原则：所有接口返回相同格式json数据

	- json对象

		- {"code":200,"message":"成功"}

	- json数组

		- [1,2,3]
[{"name":"lucy"},{"name":"mary"}]

- 2.引入service_util

	- 不同的module之间要通过pom.xml进行引用

## 统一异常处理

### 全局异常处理

- 第一步 common-service_utils创建异常处理类
- 第二步 在异常处理类添加注解
@ControllerAdvice //aop底层用到了aop，通过aop在现有功能种加入异常处理

  aop面向切面编程
  
  不改变源代码的情况下，增强功能
  
  

- 第三步 异常处理类编写针对异常处理方法，方法上面添加注解，@ExceptionHandler
位置：service_utils exception

	- @ExceptionHandler(Exception.class)// 括号内()表示针对哪个异常进行处理@ExceptionHandler(Exception.class)
	- @ResponseBody//返回json数据

- 

### 特定异常处理

### 自定义异常处理

- 第一步：创建自定义异常类，继承RuntimeException
- 第二步：在自定义异常类创建属性
- 第三步：在全局异常处理类添加自定义异常方法
- 第四步：手动抛出自定义异常

## 总结

### 搭建项目后端环境--基于maven

### 讲师后端管理

- 查询所有讲师
- 删除讲师
- 分页条件查询讲师
- 添加讲师
- 修改讲师
- 批量删除讲师

### 统一异常处理

